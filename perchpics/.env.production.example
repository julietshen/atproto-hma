# PerchPics Production Environment Configuration Example
# Rename to .env when deploying to production

# Environment configuration
NODE_ENV=production

# Frontend configuration
FRONTEND_PORT=3000

# Server configuration
PDS_PORT=3002
PORT=3002  # Keep for backward compatibility
HOST=0.0.0.0
CORS_ORIGINS=https://your-app-domain.com,https://api.your-app-domain.com

# Database configuration
DB_LOCATION=/app/data/perchpics.db

# Storage configuration
STORAGE_DIRECTORY=/app/data/blobs
STORAGE_MAX_SIZE=10485760
STORAGE_ALLOWED_TYPES=image/jpeg,image/png,image/webp

# JWT configuration - CHANGE THESE IN PRODUCTION!
JWT_SECRET=replace-with-a-secure-random-secret
JWT_EXPIRES_IN=7d

# ===== HMA Configuration =====
# Bridge Service (ATProto-HMA bridge) - the primary service the app connects to
HMA_BRIDGE_API_URL=http://atproto-hma:3001  # The ATProto-HMA bridge URL (PREFERRED)
# Legacy URL - kept for backward compatibility but HMA_BRIDGE_API_URL takes precedence
HMA_API_URL=http://atproto-hma:3001  # Must point to the bridge service

# Direct HMA Service - not used directly by the app, only by the bridge
HMA_SERVICE_API_URL=http://hma-service:5000  # The actual HMA service URL

# HMA Processing settings
HMA_API_KEY=your-hma-api-key
HMA_MATCH_THRESHOLD=0.8
HMA_RETRY_ATTEMPTS=5
HMA_RETRY_DELAY=2000
HMA_TIMEOUT=10000

# HMA Logging settings
HMA_LOG_DIR=/app/logs/hma
HMA_LOGGING_ENABLED=true
HMA_LOG_VERBOSITY=1  # Lower verbosity in production: 0=errors only, 1=basic

# Feature flags
FEATURE_OPTIMISTIC_UPDATES=true
FEATURE_FIREHOSE=true
FEATURE_MEMORY_MONITORING=true

# Memory monitoring
MEMORY_CHECK_INTERVAL_MS=300000  # 5 minutes in production
MEMORY_WARNING_THRESHOLD_MB=1024  # 1GB

# Frontend configuration
PDS_URL=https://api.your-app-domain.com
HMA_URL=https://hma.your-app-domain.com
API_TIMEOUT=60000
MAX_FILE_SIZE=10485760 